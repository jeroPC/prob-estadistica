<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Hipótesis: Lluvias</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.1.0"></script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #334155; }
        .serif { font-family: 'Lora', serif; }
        
        .card { background: white; border-radius: 12px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); overflow: hidden; margin-bottom: 2rem; }
        .card-header { padding: 1.5rem; background-color: #f1f5f9; border-bottom: 1px solid #e2e8f0; }
        
        /* Cajas de estado */
        .status-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; border-radius: 9999px; font-weight: bold; font-size: 0.875rem; }
        .status-reject { background-color: #dcfce7; color: #166534; border: 1px solid #bbf7d0; } /* Verde porque es bueno para el municipio */
        .status-fail { background-color: #fee2e2; color: #991b1b; border: 1px solid #fecaca; }
    </style>
</head>
<body class="py-10 px-4">

    <div class="max-w-4xl mx-auto">

        <header class="text-center mb-10">
            <div class="inline-block bg-blue-600 text-white px-4 py-1 rounded-full text-xs font-bold uppercase tracking-widest mb-4">
                Ejercicio 5
            </div>
            <h1 class="text-3xl font-bold text-slate-900 mb-2">Evaluación del Sistema Pluvial</h1>
            <p class="text-slate-500">Test de Hipótesis para Distribución Exponencial (Método Exacto)</p>
        </header>

        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <div class="card h-full">
                <div class="card-header flex justify-between items-center">
                    <h2 class="font-bold text-slate-700">1. Definición de Hipótesis</h2>
                    <i class="fa-solid fa-scale-balanced text-slate-400"></i>
                </div>
                <div class="p-6 space-y-4">
                    <p class="text-sm text-slate-600">Queremos demostrar que el sistema <strong>ES APTO</strong> (\(\lambda > 1/40\)).</p>
                    
                    <div class="bg-slate-50 p-3 rounded border border-slate-200">
                        <div class="flex items-center gap-3 mb-2">
                            <span class="font-bold text-red-500 w-8">H₀:</span>
                            <span class="serif">\(\lambda \le 1/40\)</span>
                            <span class="text-xs text-slate-400 uppercase">(No Apto)</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="font-bold text-green-600 w-8">H₁:</span>
                            <span class="serif">\(\lambda > 1/40\)</span>
                            <span class="text-xs text-slate-400 uppercase">(Apto)</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card h-full">
                <div class="card-header flex justify-between items-center">
                    <h2 class="font-bold text-slate-700">2. Estadístico de Prueba</h2>
                    <i class="fa-solid fa-calculator text-slate-400"></i>
                </div>
                <div class="p-6 space-y-4">
                    <p class="text-sm text-slate-600">Usamos la propiedad de la suma de exponenciales.</p>
                    <div class="text-center serif text-lg bg-indigo-50 p-3 rounded text-indigo-900 border border-indigo-100">
                        \( \chi^2 = 2 \lambda_0 n \bar{X} \)
                    </div>
                    <ul class="text-xs text-slate-500 space-y-1 mt-2">
                        <li>• \(n=10\) (Muestra chica)</li>
                        <li>• \(\bar{X}=20\) (Media muestral)</li>
                        <li>• \(\lambda_0=1/40\) (Límite frontera)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="card border-l-4 border-indigo-500">
            <div class="p-8 grid md:grid-cols-3 gap-8 text-center items-center">
                
                <div>
                    <div class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Valor Calculado</div>
                    <div class="text-4xl font-bold text-slate-800 font-mono">10.00</div>
                    <div class="text-xs text-slate-500 mt-2">\(2 \cdot \frac{1}{40} \cdot 200\)</div>
                </div>

                <div class="text-2xl text-slate-300">
                    <i class="fa-solid fa-arrow-right"></i>
                </div>

                <div>
                    <div class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-1">Valor Crítico (Tabla)</div>
                    <div class="text-4xl font-bold text-red-600 font-mono">10.85</div>
                    <div class="text-xs text-slate-500 mt-2">\(\chi^2_{0.05, 20}\) (Cola Izq)</div>
                </div>

            </div>
        </div>

        <div class="card shadow-lg">
            <div class="card-header">
                <h2 class="font-bold text-slate-700">Visualización de la Decisión</h2>
            </div>
            <div class="p-6">
                <div class="relative h-64 w-full mb-6">
                    <canvas id="chiChart"></canvas>
                </div>

                <div class="bg-green-50 border border-green-200 rounded-lg p-6 flex items-start gap-4">
                    <div class="bg-green-100 p-2 rounded-full text-green-600">
                        <i class="fa-solid fa-check text-xl"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-green-800 text-lg">Conclusión: El sistema ES APTO</h3>
                        <p class="text-green-700 mt-1 text-sm leading-relaxed">
                            Como el estadístico (10) es menor que el crítico (10.85), cae en la zona de rechazo de H₀.
                            Hay evidencia suficiente al 5% para afirmar que \(\lambda > 1/40\).
                        </p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Función Gamma para calcular densidad Chi-Cuadrado
        function gamma(n) {
            var g = 7, p = [0.99999999999980993, 676.5203681218851, -1259.1392167224028, 771.32342877765313, -176.61502916214059, 12.507343278686905, -0.13857109526572012, 9.9843695780195716e-6, 1.5056327351493116e-7];
            if (n < 0.5) return Math.PI / Math.sin(n * Math.PI) / gamma(1 - n);
            n -= 1;
            var x = 0.99999999999980993;
            for (var i = 1; i < 9; i++) x += p[i] / (n + i);
            var t = n + g + 0.5;
            return Math.sqrt(2 * Math.PI) * Math.pow(t, n + 0.5) * Math.exp(-t) * x;
        }

        function chiSquarePDF(x, k) {
            if (x <= 0) return 0;
            return (Math.pow(x, k / 2 - 1) * Math.exp(-x / 2)) / (Math.pow(2, k / 2) * gamma(k / 2));
        }

        const ctx = document.getElementById('chiChart').getContext('2d');
        const df = 20;
        const criticalVal = 10.85; // Aprox para alpha=0.05 izquierda
        const observedVal = 10.0;

        const labels = [];
        const dataPDF = [];
        
        for (let i = 0; i <= 40; i += 0.5) {
            labels.push(i.toFixed(1));
            dataPDF.push(chiSquarePDF(i, df));
        }

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Distribución Chi-Cuadrado (20 gl)',
                    data: dataPDF,
                    borderColor: '#64748b',
                    borderWidth: 2,
                    pointRadius: 0,
                    fill: {
                        target: 'origin',
                        above: (context) => {
                            const chart = context.chart;
                            const {ctx, chartArea, scales} = chart;
                            if (!chartArea) return null;
                            const x = scales.x;
                            const critPix = x.getPixelForValue(criticalVal);
                            
                            const gradient = ctx.createLinearGradient(chartArea.left, 0, chartArea.right, 0);
                            const stop = (critPix - chartArea.left) / (chartArea.right - chartArea.left);
                            
                            // Zona de Rechazo (Izquierda) -> Verde (Apto/Exito)
                            gradient.addColorStop(0, 'rgba(34, 197, 94, 0.4)'); 
                            gradient.addColorStop(stop, 'rgba(34, 197, 94, 0.4)');
                            // Zona de No Rechazo -> Gris
                            gradient.addColorStop(stop, 'rgba(0,0,0,0.05)');
                            gradient.addColorStop(1, 'rgba(0,0,0,0.05)');
                            return gradient;
                        }
                    }
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { display: false },
                    x: { min: 0, max: 40 }
                },
                plugins: {
                    annotation: {
                        annotations: {
                            lineCrit: {
                                type: 'line',
                                xMin: criticalVal,
                                xMax: criticalVal,
                                borderColor: '#ef4444',
                                borderWidth: 2,
                                borderDash: [5, 5],
                                label: {
                                    content: 'Crítico: 10.85',
                                    enabled: true,
                                    position: 'top',
                                    backgroundColor: '#ef4444',
                                    color: 'white'
                                }
                            },
                            lineObs: {
                                type: 'line',
                                xMin: observedVal,
                                xMax: observedVal,
                                borderColor: '#1e40af', // Azul oscuro
                                borderWidth: 3,
                                label: {
                                    content: 'Obs: 10.0',
                                    enabled: true,
                                    position: 'center',
                                    backgroundColor: '#1e40af',
                                    color: 'white',
                                    yAdjust: 20
                                }
                            }
                        }
                    },
                    legend: { display: false }
                }
            }
        });
    </script>
</body>
</html>