<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfico Ejercicio 3: Transformación Logarítmica</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1 { color: #2c3e50; text-align: center; }
        .card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .function-box {
            background-color: #e8f4f8;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin: 10px 0;
            font-size: 1.1em;
        }
        
        /* Estilos del Gráfico */
        .chart-container {
            position: relative;
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 8px;
        }
        svg {
            width: 100%;
            height: 100%;
            overflow: visible;
        }
        .axis { stroke: #333; stroke-width: 2; }
        .grid { stroke: #eee; stroke-width: 1; stroke-dasharray: 4; }
        .curve { fill: none; stroke: #e74c3c; stroke-width: 3; }
        .asymptote { stroke: #7f8c8d; stroke-width: 2; stroke-dasharray: 5,5; }
        .label { font-size: 12px; fill: #555; font-family: monospace; }
        .point-label { font-size: 12px; font-weight: bold; fill: #c0392b; }
        
        /* Tooltip */
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            display: none;
        }
    </style>
</head>
<body>

    <h1>Gráfico de la Función de Distribución \(F_Y(y)\)</h1>

    <div class="card">
        <h3>La Función Resultante</h3>
        <p>Recordemos la fórmula que obtuvimos:</p>
        <div class="function-box">
            $$F_Y(y) = \begin{cases} 0 & \text{si } y \le \ln(2) \\ 1 - 2e^{-y} & \text{si } y > \ln(2) \end{cases}$$
        </div>
        <p><strong>Puntos Clave para graficar:</strong></p>
        <ul>
            <li><strong>Inicio:</strong> En \(y = \ln(2) \approx 0.693\), la función vale 0.</li>
            <li><strong>Crecimiento:</strong> Sube rápidamente al principio y luego frena.</li>
            <li><strong>Asíntota:</strong> Nunca pasa de 1. Se acerca infinitamente a la línea \(y=1\).</li>
        </ul>
    </div>

    <div class="card">
        <h3>Visualización Interactiva</h3>
        <p>Pasa el mouse sobre la curva para ver los valores exactos.</p>
        
        <div class="chart-container" id="chart">
            <svg id="svgGraph" viewBox="-50 -50 550 350"></svg>
            <div id="tooltip" class="tooltip"></div>
        </div>
    </div>

    <script>
        const svg = document.getElementById('svgGraph');
        const tooltip = document.getElementById('tooltip');
        const width = 500;
        const height = 300;
        const margin = { top: 20, right: 20, bottom: 40, left: 50 };
        
        // Escalas
        // Eje X: y (de 0 a 5)
        // Eje Y: F_Y (de 0 a 1.2)
        const xScale = (val) => (val / 5) * width;
        const yScale = (val) => height - (val / 1.2) * height;

        // 1. Dibujar Ejes y Grid
        function drawAxis() {
            let html = '';
            
            // Eje X
            html += `<line x1="0" y1="${height}" x2="${width}" y2="${height}" class="axis"/>`;
            // Marcas Eje X
            for(let i=0; i<=5; i++) {
                html += `<line x1="${xScale(i)}" y1="${height}" x2="${xScale(i)}" y2="${height+5}" class="axis"/>`;
                html += `<text x="${xScale(i)}" y="${height+20}" class="label" text-anchor="middle">${i}</text>`;
            }
            html += `<text x="${width/2}" y="${height+40}" class="label" font-weight="bold">Variable y (log X)</text>`;

            // Eje Y
            html += `<line x1="0" y1="${height}" x2="0" y2="0" class="axis"/>`;
            // Marcas Eje Y
            for(let i=0; i<=10; i+=2) {
                let val = i/10;
                html += `<line x1="-5" y1="${yScale(val)}" x2="0" y2="${yScale(val)}" class="axis"/>`;
                html += `<text x="-10" y="${yScale(val)+4}" class="label" text-anchor="end">${val.toFixed(1)}</text>`;
                // Grid horizontal
                html += `<line x1="0" y1="${yScale(val)}" x2="${width}" y2="${yScale(val)}" class="grid"/>`;
            }

            // Asíntota en 1.0
            html += `<line x1="0" y1="${yScale(1)}" x2="${width}" y2="${yScale(1)}" class="asymptote"/>`;
            html += `<text x="${width-10}" y="${yScale(1)-5}" class="label" text-anchor="end" fill="#7f8c8d">Asíntota (1.0)</text>`;

            return html;
        }

        // 2. Generar la Curva
        function generatePath() {
            const startX = Math.log(2); // ~0.693
            let pathD = `M 0 ${height} L ${xScale(startX)} ${height} `; // Parte plana en 0
            
            // Parte curva
            for (let x = startX; x <= 5; x += 0.05) {
                let yVal = 1 - 2 * Math.exp(-x);
                pathD += `L ${xScale(x)} ${yScale(yVal)} `;
            }
            return `<path d="${pathD}" class="curve" id="graphLine"/>`;
        }

        // 3. Renderizar
        svg.innerHTML = drawAxis() + generatePath();

        // 4. Punto ln(2)
        const ln2X = xScale(Math.log(2));
        const ln2Y = height; // y=0
        
        const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        circle.setAttribute("cx", ln2X);
        circle.setAttribute("cy", ln2Y);
        circle.setAttribute("r", 5);
        circle.setAttribute("fill", "#c0392b");
        svg.appendChild(circle);

        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", ln2X);
        text.setAttribute("y", ln2Y - 10);
        text.setAttribute("class", "point-label");
        text.textContent = "ln(2) ≈ 0.69";
        svg.appendChild(text);

        // 5. Interacción (Tooltip)
        svg.addEventListener('mousemove', (e) => {
            const rect = svg.getBoundingClientRect();
            // Transformar coordenadas del mouse al SVG viewBox
            const mouseX = (e.clientX - rect.left) * (600 / rect.width) - 50; // Ajuste aprox
            
            // Invertir escala para obtener valor de X
            let valX = (mouseX / width) * 5; 
            if (valX < 0) valX = 0;
            if (valX > 5) valX = 5;

            // Calcular Y real
            let valY = 0;
            if (valX > Math.log(2)) {
                valY = 1 - 2 * Math.exp(-valX);
            }

            tooltip.style.display = 'block';
            tooltip.style.left = (e.clientX + 10) + 'px';
            tooltip.style.top = (e.clientY - 30) + 'px';
            tooltip.innerHTML = `y: ${valX.toFixed(2)}<br>F(y): ${valY.toFixed(3)}`;
        });

        svg.addEventListener('mouseleave', () => {
            tooltip.style.display = 'none';
        });

    </script>
</body>
</html>